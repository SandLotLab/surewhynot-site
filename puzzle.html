<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mini Puzzle — SureWhyNot</title>
  <link rel="stylesheet" href="/assets/site.css">
  <style>
    .row{display:flex; gap:10px; flex-wrap:wrap; margin-top:10px}
    input{
      width:100%;
      border-radius:12px;
      border:1px solid rgba(23,36,59,.85);
      background: rgba(11,21,40,.45);
      color:var(--text);
      padding:12px;
      font-family:inherit;
      font-size:13px;
      outline:none;
    }
    button{
      appearance:none;
      border:1px solid rgba(23,36,59,.85);
      background: linear-gradient(to bottom, rgba(11,21,40,.85), rgba(11,21,40,.55));
      color:var(--text);
      border-radius:12px;
      padding:10px 12px;
      font-family:inherit;
      cursor:pointer;
      font-size:13px;
    }
    button.primary{border-color: rgba(246,195,74,.55)}
    .msg{margin-top:10px; color:var(--muted); font-size:13px; line-height:1.5}
    .grid2{display:grid; grid-template-columns:1.2fr .8fr; gap:18px; padding:22px 0 26px}
    @media (max-width: 900px){ .grid2{grid-template-columns:1fr} }
  </style>
</head>

<script>
async function loadPartials() {
  const header = await fetch('/partials/header.html');
  const footer = await fetch('/partials/footer.html');

  document.getElementById('site-header').innerHTML = await header.text();
  document.getElementById('site-footer').innerHTML = await footer.text();
}

loadPartials();
</script>


<body>
  <div class="page">

    <div id="site-header"></div>

    <main>
      <div class="wrap">
        <section class="grid2">
          <div class="card">
            <div class="pad">
              <div class="h1">Mini Puzzle: 4-digit code</div>
              <div class="muted">
                You get 6 tries. After each guess you’ll see:
                <br>- <span class="kbd">Right</span> = correct digit in correct spot
                <br>- <span class="kbd">Close</span> = digit exists but in wrong spot
              </div>

              <div class="hr"></div>

              <input id="guess" placeholder="Type 4 digits (example: 0834)" inputmode="numeric" maxlength="4" />
              <div class="row">
                <button class="primary" id="btnTry">Try</button>
                <button id="btnNew">New Puzzle</button>
              </div>

              <div class="msg" id="out"></div>
            </div>
          </div>

          <div class="card">
            <div class="pad">
              <div class="h1">Ad slot placeholder</div>
              <div class="adslot">
                <b>[ AdSense Slot Here ]</b>
              </div>
              <div class="hr"></div>
              <div class="muted">Fast, small, replayable.</div>
            </div>
          </div>
        </section>
      </div>
    </main>

    <div id="site-footer"></div>

  </div>

<script>
(() => {
  const guessEl = document.getElementById("guess");
  const out = document.getElementById("out");
  const btnTry = document.getElementById("btnTry");
  const btnNew = document.getElementById("btnNew");

  let secret = "";
  let tries = 0;
  const maxTries = 6;

  function newPuzzle(){
    secret = String(Math.floor(Math.random()*10000)).padStart(4,"0");
    tries = 0;
    out.textContent = "New puzzle ready.";
    guessEl.value = "";
    guessEl.focus();
  }

  function score(guess){
    let right = 0, close = 0;
    const s = secret.split("");
    const g = guess.split("");

    const usedS = Array(4).fill(false);
    const usedG = Array(4).fill(false);

    for(let i=0;i<4;i++){
      if(g[i] === s[i]){
        right++;
        usedS[i]=true;
        usedG[i]=true;
      }
    }
    for(let i=0;i<4;i++){
      if(usedG[i]) continue;
      for(let j=0;j<4;j++){
        if(usedS[j]) continue;
        if(g[i] === s[j]){
          close++;
          usedS[j]=true;
          usedG[i]=true;
          break;
        }
      }
    }
    return {right, close};
  }

  btnTry.addEventListener("click", () => {
    const guess = guessEl.value.trim();
    if(!/^\d{4}$/.test(guess)){
      out.textContent = "Enter exactly 4 digits.";
      return;
    }
    tries++;
    const {right, close} = score(guess);

    if(guess === secret){
      out.textContent = `Solved in ${tries}/${maxTries}. Code: ${secret}`;
      return;
    }

    if(tries >= maxTries){
      out.textContent = `Out of tries. Code was ${secret}. Click New Puzzle.`;
      return;
    }

    out.textContent = `Try ${tries}/${maxTries}: Right ${right}, Close ${close}`;
    guessEl.focus();
    guessEl.select();
  });

  btnNew.addEventListener("click", newPuzzle);

  newPuzzle();
})();
</script>
</body>
</html>
